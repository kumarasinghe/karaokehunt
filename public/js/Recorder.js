class Recorder{constructor(e){this.readyCallback=e,this.recordingDeviceId="default",this.audioChunks=[],this.audioContext=new AudioContext,this.analyserNode=this.audioContext.createAnalyser(),this.analyserFrequencyCount=128,this.analyserNode.fftSize=this.analyserFrequencyCount,this.frequencyData=new Uint8Array(this.analyserNode.frequencyBinCount),this.setupRecorder()}setupRecorder(){let e={deviceId:this.recordingDeviceId,autoGainControl:!1,channelCount:{ideal:2,min:1},echoCancellation:!1,noiseSuppression:!0,sampleRate:48e3,sampleSize:24,volume:1};navigator.mediaDevices.getUserMedia({audio:e}).then(e=>{this.audioContext.createMediaStreamSource(e).connect(this.analyserNode),this.mediaRecorder=new MediaRecorder(e),this.mediaRecorder.addEventListener("dataavailable",e=>{this.audioChunks.push(e.data)}),this.mediaRecorder.addEventListener("stop",()=>{this.audioBlob=new Blob(this.audioChunks,{type:"audio/ogg; codecs=opus"}),this.recordCompleteCallback&&(this.audioUrl=URL.createObjectURL(this.audioBlob),this.recordCompleteCallback(this.audioUrl,this.audioBlob,this.audioChunks))}),this.readyCallback&&this.readyCallback()}).catch(function(e){swal("Mic Access Denied","Please reload the page and grant access to your microphone","error")})}start(){this.audioContext.resume(),this.audioChunks=[],this.mediaRecorder.start()}stop(e){this.recordCompleteCallback=e,this.mediaRecorder.stop()}getFrequencyData(){return this.analyserNode.getByteFrequencyData(this.frequencyData),this.frequencyData}getAudioInputDevices(e){navigator.mediaDevices.enumerateDevices().then(t=>{let a=[];for(var i=0;i<t.length;++i){var o=t[i];console.log(o),"audioinput"===o.kind&&a.push(o)}e(a)}).catch(()=>{console.error("An error occured while getting audio devices")})}setRecordingDevice(e){this.recordingDeviceId=e}}
